{% extends 'profile.html' %}

{% block content %}
<div>
    <center>
        <h1>
            User: {{ user_to_show }}
            {% if not_same_user %}
            {% if already_friends %}
            <form class="d-flex" method=POST action="{% url 'delete_friend' user_to_show.id %}">
                {% csrf_token %}
                <button class="btn btn-danger" type="submit">Remove Friend</button>
            </form>
            <form class="d-flex" method=POST action="{% url 'block_friend' user_to_show.id %}">
                {% csrf_token %}
                <button class="btn btn-danger" type="submit">Block Friend</button>
            </form>
            <form class="d-flex" method=POST action="{% url 'unblock_friend' user_to_show.id %}">
                {% csrf_token %}
                <button class="btn btn-danger" type="submit">Unblock Friend</button>
            </form>
            {% elif request_info.request_from_them %}
            <form class="d-flex" method=POST action="{% url 'accept_friend_request_profile' user_to_show.id %}">
                {% csrf_token %}
                <button class="btn btn-primary" type="submit">Accept Friend Request</button>
            </form>
            {% elif request_info.request_to_them %}
            <br> Friend request pending.. <br>
            {% else %}
            <form class="d-flex" method=POST action="{% url 'add_friend' user_to_show.id %}">
                {% csrf_token %}
                <button class="btn btn-primary" type="submit">Add Friend</button>
            </form>
            {% endif %}
            {% endif %}
        </h1>
        UserID: {{ user_to_show.id }} <br>
        {% load friendshiptags %}
        Friends:<br>
        {% for friends in allfriends %}
        <li>
            <a href="{% url 'show_user' friends.id %}">{{ friends.username }}</a><br>
        </li>
        {% endfor %}<br>
    </center>
    <h1>My Playlists:</h1>
    <table class="table table-bordered">
        <thead>
            <tr>
                <th scope="col">#</th>
                <th scope="col">Playlist Name</th>
            </tr>
        </thead>
        <tbody>
            {% for playlist in playlists %}
            <tr>
                <th scope="row">{{forloop.counter}}</th>
                <td><a href="{% url 'addsongs_view' playlist.id %}"> {{ playlist.name }}</a></td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    <br>
    <h1>Saved Playlists:</h1>
    <table class="table table-bordered">
        <thead>
            <tr>
                <th scope="col">#</th>
                <th scope="col">Playlist Name</th>
            </tr>
        </thead>
        <tbody>
            {% for playlist in saved_playlists %}
            <tr>
                <th scope="row">{{forloop.counter}}</th>
                <td><a href="{% url 'addsongs_view' playlist.saved_playlist.id %}"> {{ playlist.saved_playlist }}</a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    <br>
    <h1>Ratings:</h1>
    <table class="table table-bordered">
        <thead>
            <tr>
                <th scope="col">Rating Type</th>
                <th scope="col">Ratings</th>
            </tr>
        </thead>
        <tbody>
            {% for rating in song_ratings %}
            {% if rating.rating_type %}
            <tr>
                <td>Upvote</td>
                <td><a href="{% url 'songinfo' rating.song_id.id %}">Song: {{ rating.song_id }}</a></td>
            </tr>
            {% else %}
            <tr>
                <td>Downvote</td>
                <td><a href="{% url 'songinfo' rating.song_id.id %}">Song: {{ rating.song_id }}</a></td>
            </tr>
            {% endif %}
            {% endfor %}
            {% for rating in album_ratings %}
            {% if rating.rating_type %}
            <tr>
                <td>Upvote</td>
                <td><a href="{% url 'album_info' rating.album_id.id %}">Album: {{ rating.album_id }}</a></td>
            </tr>
            {% else %}
            <tr>
                <td>Downvote</td>
                <td><a href="{% url 'album_info' rating.album_id.id %}">Album: {{ rating.album_id }}</a></td>
            </tr>
            {% endif %}
            {% endfor %}
            {% for rating in playlist_ratings %}
            {% if rating.rating_type %}
            <tr>
                <td>Upvote</td>
                <td><a href="{% url 'addsongs_view' rating.playlist_id.id %}">Playlist: {{ rating.playlist_id }}</a></td>
            </tr>
            {% else %}
            <tr>
                <td>Downvote</td>
                <td><a href="{% url 'addsongs_view' rating.playlist_id.id %}">Playlist: {{ rating.playlist_id }}</a></td>
            </tr>
            {% endif %}
            {% endfor %}
        </tbody>
    </table>
    <br>
    <h1>Comments:</h1>
    <table class="table table-bordered">
        <thead>
            <tr>
                <th scope="col">Content</th>
                <th scope="col">Comment</th>
            </tr>
        </thead>
        <tbody>
            {% for comment in comments %}
            {% if comment.content_type.name == 'song' %}
            {% for song in song %}
            {% if song.id == comment.object_pk %}
            <tr>   
                <td><a href="{% url 'songinfo' comment.object_pk %}">{{ song.name }}</a></td>
                <td><a>{{ comment.comment }}</a></td>
            </tr>
            {% endif %}
            {% endfor %}
            {% endif %}
            {% if comment.content_type.name == 'album' %}
            {% for album in album %}
            {% if album.id == comment.object_pk %}
            <tr>   
                <td><a href="{% url 'album_info' comment.object_pk %}">{{ album.name }}</a></td>
                <td><a>{{ comment.comment }}</a></td>
            </tr>
            {% endif %}
            {% endfor %}
            {% endif %}
            {% if comment.content_type.name == 'playlist' %}
            {% for playlist in playlist %}
            {% if playlist.id == comment.object_pk %}
            <tr>   
                <td><a href="{% url 'addsongs_view' comment.object_pk %}">{{ playlist.name }}</a></td>
                <td><a>{{ comment.comment }}</a></td>
            </tr>
            {% endif %}
            {% endfor %}
            {% endif %}
            {% endfor %}

             
        </tbody>
    </table>
</div>



{% endblock %}
{% load static %}
{% include 'base.html' %}
{% load comments %}
{% load comments_xtd %}

{% block content %}

<h1> Album: {{album.name}} </h1>
<h5> Amount of tracks: {{album.total_tracks}}</h5>
<h2> Released: {{album.release_date}} </h2>

<h2> Artist(s): {{album.artists}} </h2>

<!--<div class="card" style="width: 40rem;">
  <div class="card-body">
    <iframe class="album_info_iframe" src="https://open.spotify.com/embed/album/{{id}}" width="100%" height="380"
      frameBorder="0" allowfullscreen=""
      allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture">
    </iframe>
  </div>
</div>-->

<img src="{{album.cover}}">

<div>
  {% if songs %}
  {%for song in songs %}
  {% if song.explicit %}
  <a href="{% url 'songinfo' song.id %}">{{forloop.counter}}. {{song.name}} | {{song.duration}} <b>(Explicit)</b> </a>
  {% else %}
  <a href="{% url 'songinfo' song.id %}">{{forloop.counter}}. {{song.name}} | {{song.duration}}</a>
  {% endif %}
  <br>
  {% endfor %}
  {% endif %}
</div>

{% get_comment_count for albumid as comment_count %}
  <div class="py-4 text-center">
    <a href="{% url 'search' %}">Back to search page</a>
    &nbsp;&sdot;&nbsp;
    {{ comment_count }} comment{{ comment_count|pluralize }}
    ha{{ comment_count|pluralize:"s,ve"}} been posted.
  </div>

  {% if comment_count %}
  <ul class="media-list">
    {% render_xtdcomment_tree for albumid %}
  </ul>
  {% endif %}

  {% if albumid.allow_comments %}
  <div class="comment mt-3 mb-5">
    <h4 class="text-center mb-4">Post a Comment</h4>
    <div class="card pt-4">
      {% render_comment_form for albumid %}
    </div>
    {% endif %}

{% endblock %}


<script type="text/javascript">
  if ("{{ user.userExt.dark_mode }}" == "True") {
    document.write('<link rel="stylesheet" type="text/css" href="{% static 'css/dark_mode.css' %}">');
  }
</script>